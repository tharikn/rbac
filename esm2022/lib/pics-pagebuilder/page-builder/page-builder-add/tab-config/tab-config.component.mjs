import { Component } from '@angular/core';
import { Validators } from '@angular/forms';
import { AppConstants } from '../../../@core/constants/app-constants';
import { AuthService } from '../../../@core/services/auth.service';
import { CommonDropdownsService } from '../../../@core/services/common-dropdowns.service';
import { LocalService } from '../../../@core/services/local.service';
import { PageBuilderAddService } from '../../../@core/services/page-builder-add.service';
import { PageBuilderService } from '../../page-builder-version/@core/page-builder.service';
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
import * as i2 from "../../../@core/services/alert.service";
import * as i3 from "@angular/router";
import * as i4 from "../../../@core/services/data-store.service";
import * as i5 from "@angular/common";
import * as i6 from "primeng/inputtext";
import * as i7 from "primeng/dropdown";
import * as i8 from "primeng/card";
import * as i9 from "../../../@core/directives/permission.directive";
export class TabConfigComponent {
    _formBuilder;
    _alert;
    _route;
    _router;
    _storeservice;
    tabsForm;
    formData;
    id = '';
    pageTypeList;
    dropdownService;
    pageList;
    filteredPageList;
    pageBuilderAddService;
    pageBuilderService;
    authService;
    orgSubs;
    orgId;
    fieldList = [];
    allFieldList = [];
    parentFieldList = [];
    tempList = [];
    pageErrorShow = false;
    tabErrorShow = false;
    basicPageInformation;
    localStore;
    httpService;
    RBACORG;
    constructor(injector, _formBuilder, _alert, _route, _router, _storeservice) {
        this._formBuilder = _formBuilder;
        this._alert = _alert;
        this._route = _route;
        this._router = _router;
        this._storeservice = _storeservice;
        this.pageBuilderAddService = injector.get(PageBuilderAddService);
        this.dropdownService = injector.get(CommonDropdownsService);
        this.pageBuilderService = injector.get(PageBuilderService);
        this.authService = injector.get(AuthService);
        this.localStore = injector.get(LocalService);
        this.id = this._route.snapshot.parent.paramMap.get('id');
        this._storeservice.currentStore.subscribe((res) => {
            if (res) {
                this.httpService = res['HTTPSERVICE'];
                this.RBACORG = res['RBACORG'];
                this.orgId = parseInt(this.RBACORG['orgID']);
                if (this.orgId) {
                    this.getAllPages();
                }
            }
        });
        this.basicPageInformation = this.localStore.getObj('PAGEDESIGN_BASICINFO');
    }
    ngOnInit() {
        if (!this.id) {
            const validation = this.validationPage();
            if (!validation) {
                this._router.navigate(['/pages/page-design/add/basic-info'], { relativeTo: this._route });
                return this._alert.error('Please fill in all the required fields.');
            }
        }
        this.getPageTypes();
        this.initTabConfigForm();
    }
    validationPage() {
        if (!this.basicPageInformation.pagename ||
            !this.basicPageInformation.pagetype ||
            !this.basicPageInformation.description) {
            return false;
        }
        else {
            return true;
        }
    }
    ngOnDestroy() {
        this.orgSubs.unsubscribe();
    }
    setCurrentFormData() {
        this.pageBuilderAddService.currentFormData.subscribe((data) => {
            this.formData = data;
            const tabConfig = this.formData ? JSON.parse(this.formData?.tabconfig) : null;
            if (tabConfig) {
                const tabsControl = this.tabsForm.controls['tabs'];
                tabsControl.controls = [];
                if (tabConfig?.length) {
                    tabConfig.forEach((val, index) => {
                        tabsControl.push(this._formBuilder.group({
                            id: val.id,
                            name: val.name,
                            field: val.field,
                            pfield: val.pfield,
                            icon: val.icon
                        }));
                        this.onChange(val.id, index);
                    });
                }
            }
        });
    }
    initTabConfigForm() {
        this.tabsForm = this._formBuilder.group({
            tabs: this._formBuilder.array([this.addTabGroup()])
        });
    }
    getPageTypes() {
        this.dropdownService.getDropDownValues('page').subscribe(result => {
            this.pageTypeList = result['data'];
        });
    }
    getAllPages() {
        this.pageBuilderAddService.getOrgList(this.orgId).subscribe((res) => {
            if (res) {
                this.pageList = res?.data?.filter(page => page?.pageTypeDetails?.key !== 'BTP');
                this.setCurrentFormData();
            }
        }, _err => this._alert.error(AppConstants.errorMessage));
    }
    // selectedPageType(event) {
    //   console.log(event);
    //   this.filteredPageList = this.pageList.filter(page => page.pageTypeDetails.id === event);
    // }
    addTabGroup() {
        return this._formBuilder.group({
            name: ['', [Validators.required]],
            id: ['', [Validators.required]],
            field: [''],
            pfield: [''],
            icon: [''],
            tableName: ['']
        });
    }
    get tabs() {
        return this.tabsForm.get('tabs').controls;
    }
    addTab() {
        const tabs = this.tabsForm.get('tabs').controls;
        tabs.push(this.addTabGroup());
        this.tabErrorShow = false;
        this.pageErrorShow = false;
    }
    // patchTab(tabValue) {
    //   const tabs = (this.tabsForm.get('tabs') as FormArray).controls;
    //   tabs.push(tabValue);
    // }
    // /**
    //  * Method to Remove tab
    //  * @param _index index of the tab to be removed
    //  */
    removeTab(_index) {
        const tabs = this.tabsForm.get('tabs');
        tabs.removeAt(_index);
    }
    // getPage(id?: any) {
    //   console.log(id);
    //   if (id && id !== '') {
    //     return this.pageList.filter(_ => _.pageTypeDetails.id == id);
    //   }
    // }
    cancel() {
        this.pageBuilderAddService.returnToList();
    }
    saveTabs(publish) {
        console.log(this.tabsForm.getRawValue());
        console.log(this.tabsForm.valid);
        // TODO: change to tabconfig
        const tabs = this.tabsForm.getRawValue().tabs;
        this.tabErrorShow = true;
        this.pageErrorShow = true;
        tabs.forEach(tab => {
            tab.type = this.pageList.length && this.pageList.filter(page => page.id === tab.id)[0]?.pageTypeDetails?.key;
            tab.tableName = JSON.parse(this.pageList.length && this.pageList.filter(page => page.id === tab.id)[0]?.activeVersion?.tableschemaconfig)?.tablelist;
            tab.parentTableName = tab.pfield?.split('.')[0];
        });
        this.formData.tabconfig = JSON.stringify(tabs);
        console.log('Saving....');
        console.log(this.formData);
        if (!this.id) {
            this.formData.published = publish;
            this.pageBuilderAddService.createPage(this.formData).subscribe(result => {
                const data = result['data'];
                this._router.navigate([`pages/page-design/versions/${data.id}`]);
                if (publish) {
                    this._alert.success(`Tab Page Version ${data.version || data.activeVersion.version}  is published successfully`);
                }
                else {
                    this._alert.success('Tab Page added successfully');
                }
            });
        }
        else {
            const formDetails = this.formData;
            formDetails.id = this.id;
            formDetails.published = publish;
            this.pageBuilderService.updatePageVersion(this.id, formDetails).subscribe(() => {
                this._router.navigate([`pages/page-design/versions/${formDetails.pageid}`]);
                this._alert.success('Tab Page updated successfully');
            });
        }
    }
    onChange(value, index) {
        if (value) {
            const selectedPage = this.pageList && this.pageList?.length ? this.pageList.find(x => x.id == value) : {};
            const fieldmapping = selectedPage.activeVersion
                ? JSON.parse(selectedPage?.activeVersion?.tableschemaconfig)?.fieldmapping
                : [];
            const data = fieldmapping && fieldmapping?.length
                ? fieldmapping.map(element => {
                    element.label = element.tablename + '.' + element.field;
                    return element;
                })
                : [];
            this.pageList[index].fieldmapping = data;
        }
        else {
            this.pageList[index].fieldmapping = [];
        }
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TabConfigComponent, deps: [{ token: i0.Injector }, { token: i1.UntypedFormBuilder }, { token: i2.AlertService }, { token: i3.ActivatedRoute }, { token: i3.Router }, { token: i4.DataStoreService }], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.2.12", type: TabConfigComponent, selector: "app-tab-config", ngImport: i0, template: "<div class=\"page-design-basic-info\">\r\n  <p-card styleClass=\"rbac-card w-100 mb-2\">\r\n    <div class=\"strip_head page-designer toggleleft\">\r\n      <span class=\"report_head font-weight-bold\">Tab Configuration</span>\r\n    </div>\r\n    <div class=\"p-fluid\">\r\n      <div class=\"\">\r\n        <form [formGroup]=\"tabsForm\">\r\n          <div class=\"strip_head toggleleft page-designer d-flex justify-content-between mb-4\">\r\n            <span class=\"report_head font-weight-bold\"></span>\r\n            <button class=\"btn btn-primary\" fieldKey=\"PAG_DES_TAB_CONFIG_ADD_TAB\" (click)=\"addTab()\">\r\n              <em class=\"fa fa-plus\" aria-hidden=\"true\"></em> Add Tab\r\n            </button>\r\n          </div>\r\n          <table aria-describedby=\"gridConfigTable\" class=\"table table-borderless actionadd mb-0\">\r\n            <thead>\r\n              <tr>\r\n                <th scope=\"col\">Tab Name <span class=\"requiredfield text-danger\">*</span></th>\r\n                <th scope=\"col\">Icon</th>\r\n                <th scope=\"col\">Page <span class=\"requiredfield text-danger\">*</span></th>\r\n                <th scope=\"col\">Field Mapping</th>\r\n                <th scope=\"col\">Parent Field Mapping</th>\r\n                <th scope=\"col\">&#160;</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody formArrayName=\"tabs\" *ngFor=\"let item of tabs; let i = index\">\r\n              <tr [formGroupName]=\"i\">\r\n                <td>\r\n                  <input\r\n                    type=\"text\"\r\n                    class=\"form-control\"\r\n                    formControlName=\"name\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_TAB_NAME\"\r\n                    placeholder=\"Enter Tab Name\"\r\n                    pInputText\r\n                    required />\r\n                  <div\r\n                    *ngIf=\"\r\n                      tabErrorShow ? item.get('name').invalid : item.get('name').errors && item.get('name').touched\r\n                    \">\r\n                    <div class=\"p-error block mt-1\">Tab Name is required </div>\r\n                  </div>\r\n                </td>\r\n                <td>\r\n                  <input\r\n                    type=\"text\"\r\n                    class=\"form-control\"\r\n                    formControlName=\"icon\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_TAB_NAME\"\r\n                    placeholder=\"Enter Icon\"\r\n                    pInputText />\r\n                </td>\r\n                <td>\r\n                  <p-dropdown\r\n                    [options]=\"this.pageList\"\r\n                    placeholder=\"Select Page\"\r\n                    id=\"pagetype\"\r\n                    optionLabel=\"activeVersion.pagename\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_SELECT_PAGE\"\r\n                    optionValue=\"id\"\r\n                    formControlName=\"id\"\r\n                    [filter]=\"true\"\r\n                    (onChange)=\"onChange($event.value, i)\"\r\n                    [required]=\"true\">\r\n                  </p-dropdown>\r\n                  <div *ngIf=\"pageErrorShow ? item.get('id').invalid : item.get('id').errors && item.get('id').touched\">\r\n                    <div class=\"p-error block mt-1\">Page is required </div>\r\n                  </div>\r\n                </td>\r\n                <td>\r\n                  <p-dropdown\r\n                    [options]=\"pageList && pageList?.length ? pageList[i].fieldmapping : []\"\r\n                    placeholder=\"Select Field\"\r\n                    id=\"field\"\r\n                    optionLabel=\"field\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_SELECT_PAGE\"\r\n                    optionValue=\"field\"\r\n                    formControlName=\"field\"\r\n                    [filter]=\"true\">\r\n                  </p-dropdown>\r\n                </td>\r\n                <td>\r\n                  <p-dropdown\r\n                    [options]=\"this.parentFieldList[i]\"\r\n                    placeholder=\"Select Parent Field\"\r\n                    id=\"field\"\r\n                    optionLabel=\"label\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_SELECT_PAGE\"\r\n                    optionValue=\"label\"\r\n                    formControlName=\"pfield\"\r\n                    [filter]=\"true\">\r\n                  </p-dropdown>\r\n                </td>\r\n                <td class=\"text-center\" *ngIf=\"tabs.length > 1\">\r\n                  <a\r\n                    href=\"javascript:void(0)\"\r\n                    class=\"text-danger trash-align\"\r\n                    title=\"Delete\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_DELETE\">\r\n                    <em class=\"pi pi-trash\" (click)=\"removeTab(i)\"></em>\r\n                  </a>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </p-card>\r\n  <div class=\"formicon mt-3 text-right\">\r\n    <button class=\"mb-2 mr-2 btn btn-cancel\" (click)=\"cancel()\">Cancel</button>\r\n    <button class=\"mb-2 mr-2 btn btn-primary btncommon\" fieldKey=\"PAG_DES_TAB_CONFIG_PUBLISH\" (click)=\"saveTabs(true)\">\r\n      Publish\r\n    </button>\r\n    <button class=\"mb-2 btn btn-primary btncommon\" fieldKey=\"PAG_DES_TAB_CONFIG_SAVE_TABS\" (click)=\"saveTabs(false)\">\r\n      Save\r\n    </button>\r\n  </div>\r\n</div>\r\n", styles: ["li{list-style:none}.page-design-basic-info .p-card-content{padding:0}.table.actionadd thead{background-color:var(--background-color)}.table.actionadd thead tr th{color:var(--text-dark);padding:10px 8px}.table.actionadd tbody tr td{padding-left:8px;padding-right:8px}.table thead{background-color:var(--background-color)}.text-danger{color:#d62f3f!important}.table{width:100%;margin-bottom:1rem;color:#212529;border:solid 1px #ddd}.trash-align .pi-trash{line-height:2}\n"], dependencies: [{ kind: "directive", type: i5.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i5.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i1.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { kind: "directive", type: i1.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i1.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i1.RequiredValidator, selector: ":not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]", inputs: ["required"] }, { kind: "directive", type: i1.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i1.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }, { kind: "directive", type: i1.FormGroupName, selector: "[formGroupName]", inputs: ["formGroupName"] }, { kind: "directive", type: i1.FormArrayName, selector: "[formArrayName]", inputs: ["formArrayName"] }, { kind: "directive", type: i6.InputText, selector: "[pInputText]" }, { kind: "component", type: i7.Dropdown, selector: "p-dropdown", inputs: ["id", "scrollHeight", "filter", "name", "style", "panelStyle", "styleClass", "panelStyleClass", "readonly", "required", "editable", "appendTo", "tabindex", "placeholder", "filterPlaceholder", "filterLocale", "inputId", "dataKey", "filterBy", "filterFields", "autofocus", "resetFilterOnHide", "dropdownIcon", "optionLabel", "optionValue", "optionDisabled", "optionGroupLabel", "optionGroupChildren", "autoDisplayFirst", "group", "showClear", "emptyFilterMessage", "emptyMessage", "lazy", "virtualScroll", "virtualScrollItemSize", "virtualScrollOptions", "overlayOptions", "ariaFilterLabel", "ariaLabel", "ariaLabelledBy", "filterMatchMode", "maxlength", "tooltip", "tooltipPosition", "tooltipPositionStyle", "tooltipStyleClass", "focusOnHover", "selectOnFocus", "autoOptionFocus", "autofocusFilter", "disabled", "itemSize", "autoZIndex", "baseZIndex", "showTransitionOptions", "hideTransitionOptions", "filterValue", "options"], outputs: ["onChange", "onFilter", "onFocus", "onBlur", "onClick", "onShow", "onHide", "onClear", "onLazyLoad"] }, { kind: "component", type: i8.Card, selector: "p-card", inputs: ["header", "subheader", "style", "styleClass"] }, { kind: "directive", type: i9.PermissionDirective, selector: "[fieldKey]", inputs: ["fieldKey"] }] });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TabConfigComponent, decorators: [{
            type: Component,
            args: [{ selector: 'app-tab-config', template: "<div class=\"page-design-basic-info\">\r\n  <p-card styleClass=\"rbac-card w-100 mb-2\">\r\n    <div class=\"strip_head page-designer toggleleft\">\r\n      <span class=\"report_head font-weight-bold\">Tab Configuration</span>\r\n    </div>\r\n    <div class=\"p-fluid\">\r\n      <div class=\"\">\r\n        <form [formGroup]=\"tabsForm\">\r\n          <div class=\"strip_head toggleleft page-designer d-flex justify-content-between mb-4\">\r\n            <span class=\"report_head font-weight-bold\"></span>\r\n            <button class=\"btn btn-primary\" fieldKey=\"PAG_DES_TAB_CONFIG_ADD_TAB\" (click)=\"addTab()\">\r\n              <em class=\"fa fa-plus\" aria-hidden=\"true\"></em> Add Tab\r\n            </button>\r\n          </div>\r\n          <table aria-describedby=\"gridConfigTable\" class=\"table table-borderless actionadd mb-0\">\r\n            <thead>\r\n              <tr>\r\n                <th scope=\"col\">Tab Name <span class=\"requiredfield text-danger\">*</span></th>\r\n                <th scope=\"col\">Icon</th>\r\n                <th scope=\"col\">Page <span class=\"requiredfield text-danger\">*</span></th>\r\n                <th scope=\"col\">Field Mapping</th>\r\n                <th scope=\"col\">Parent Field Mapping</th>\r\n                <th scope=\"col\">&#160;</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody formArrayName=\"tabs\" *ngFor=\"let item of tabs; let i = index\">\r\n              <tr [formGroupName]=\"i\">\r\n                <td>\r\n                  <input\r\n                    type=\"text\"\r\n                    class=\"form-control\"\r\n                    formControlName=\"name\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_TAB_NAME\"\r\n                    placeholder=\"Enter Tab Name\"\r\n                    pInputText\r\n                    required />\r\n                  <div\r\n                    *ngIf=\"\r\n                      tabErrorShow ? item.get('name').invalid : item.get('name').errors && item.get('name').touched\r\n                    \">\r\n                    <div class=\"p-error block mt-1\">Tab Name is required </div>\r\n                  </div>\r\n                </td>\r\n                <td>\r\n                  <input\r\n                    type=\"text\"\r\n                    class=\"form-control\"\r\n                    formControlName=\"icon\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_TAB_NAME\"\r\n                    placeholder=\"Enter Icon\"\r\n                    pInputText />\r\n                </td>\r\n                <td>\r\n                  <p-dropdown\r\n                    [options]=\"this.pageList\"\r\n                    placeholder=\"Select Page\"\r\n                    id=\"pagetype\"\r\n                    optionLabel=\"activeVersion.pagename\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_SELECT_PAGE\"\r\n                    optionValue=\"id\"\r\n                    formControlName=\"id\"\r\n                    [filter]=\"true\"\r\n                    (onChange)=\"onChange($event.value, i)\"\r\n                    [required]=\"true\">\r\n                  </p-dropdown>\r\n                  <div *ngIf=\"pageErrorShow ? item.get('id').invalid : item.get('id').errors && item.get('id').touched\">\r\n                    <div class=\"p-error block mt-1\">Page is required </div>\r\n                  </div>\r\n                </td>\r\n                <td>\r\n                  <p-dropdown\r\n                    [options]=\"pageList && pageList?.length ? pageList[i].fieldmapping : []\"\r\n                    placeholder=\"Select Field\"\r\n                    id=\"field\"\r\n                    optionLabel=\"field\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_SELECT_PAGE\"\r\n                    optionValue=\"field\"\r\n                    formControlName=\"field\"\r\n                    [filter]=\"true\">\r\n                  </p-dropdown>\r\n                </td>\r\n                <td>\r\n                  <p-dropdown\r\n                    [options]=\"this.parentFieldList[i]\"\r\n                    placeholder=\"Select Parent Field\"\r\n                    id=\"field\"\r\n                    optionLabel=\"label\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_SELECT_PAGE\"\r\n                    optionValue=\"label\"\r\n                    formControlName=\"pfield\"\r\n                    [filter]=\"true\">\r\n                  </p-dropdown>\r\n                </td>\r\n                <td class=\"text-center\" *ngIf=\"tabs.length > 1\">\r\n                  <a\r\n                    href=\"javascript:void(0)\"\r\n                    class=\"text-danger trash-align\"\r\n                    title=\"Delete\"\r\n                    fieldKey=\"PAG_DES_TAB_CONFIG_DELETE\">\r\n                    <em class=\"pi pi-trash\" (click)=\"removeTab(i)\"></em>\r\n                  </a>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </p-card>\r\n  <div class=\"formicon mt-3 text-right\">\r\n    <button class=\"mb-2 mr-2 btn btn-cancel\" (click)=\"cancel()\">Cancel</button>\r\n    <button class=\"mb-2 mr-2 btn btn-primary btncommon\" fieldKey=\"PAG_DES_TAB_CONFIG_PUBLISH\" (click)=\"saveTabs(true)\">\r\n      Publish\r\n    </button>\r\n    <button class=\"mb-2 btn btn-primary btncommon\" fieldKey=\"PAG_DES_TAB_CONFIG_SAVE_TABS\" (click)=\"saveTabs(false)\">\r\n      Save\r\n    </button>\r\n  </div>\r\n</div>\r\n", styles: ["li{list-style:none}.page-design-basic-info .p-card-content{padding:0}.table.actionadd thead{background-color:var(--background-color)}.table.actionadd thead tr th{color:var(--text-dark);padding:10px 8px}.table.actionadd tbody tr td{padding-left:8px;padding-right:8px}.table thead{background-color:var(--background-color)}.text-danger{color:#d62f3f!important}.table{width:100%;margin-bottom:1rem;color:#212529;border:solid 1px #ddd}.trash-align .pi-trash{line-height:2}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.Injector }, { type: i1.UntypedFormBuilder }, { type: i2.AlertService }, { type: i3.ActivatedRoute }, { type: i3.Router }, { type: i4.DataStoreService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFiLWNvbmZpZy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9waWNzLW1vZHVsZS9wYWdlLWJ1aWxkZXIvc3JjL2xpYi9waWNzLXBhZ2VidWlsZGVyL3BhZ2UtYnVpbGRlci9wYWdlLWJ1aWxkZXItYWRkL3RhYi1jb25maWcvdGFiLWNvbmZpZy5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9waWNzLW1vZHVsZS9wYWdlLWJ1aWxkZXIvc3JjL2xpYi9waWNzLXBhZ2VidWlsZGVyL3BhZ2UtYnVpbGRlci9wYWdlLWJ1aWxkZXItYWRkL3RhYi1jb25maWcvdGFiLWNvbmZpZy5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUErQixNQUFNLGVBQWUsQ0FBQztBQUN2RSxPQUFPLEVBQThFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBR3hILE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUV0RSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFDbkUsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sa0RBQWtELENBQUM7QUFFMUYsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHVDQUF1QyxDQUFDO0FBQ3JFLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGtEQUFrRCxDQUFDO0FBQ3pGLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHVEQUF1RCxDQUFDOzs7Ozs7Ozs7OztBQU0zRixNQUFNLE9BQU8sa0JBQWtCO0lBeUJuQjtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBNUJWLFFBQVEsQ0FBb0I7SUFDNUIsUUFBUSxDQUFNO0lBQ2QsRUFBRSxHQUFHLEVBQUUsQ0FBQztJQUNSLFlBQVksQ0FBTTtJQUNsQixlQUFlLENBQXlCO0lBQ3hDLFFBQVEsQ0FBTTtJQUNkLGdCQUFnQixDQUFNO0lBQ3RCLHFCQUFxQixDQUF3QjtJQUM3QyxrQkFBa0IsQ0FBcUI7SUFDdkMsV0FBVyxDQUFjO0lBQ3pCLE9BQU8sQ0FBZTtJQUN0QixLQUFLLENBQU07SUFDWCxTQUFTLEdBQVEsRUFBRSxDQUFDO0lBQ3BCLFlBQVksR0FBUSxFQUFFLENBQUM7SUFDdkIsZUFBZSxHQUFRLEVBQUUsQ0FBQztJQUMxQixRQUFRLEdBQVEsRUFBRSxDQUFDO0lBQ25CLGFBQWEsR0FBRyxLQUFLLENBQUM7SUFDdEIsWUFBWSxHQUFHLEtBQUssQ0FBQztJQUNyQixvQkFBb0IsQ0FBTTtJQUMxQixVQUFVLENBQWU7SUFDekIsV0FBVyxDQUFNO0lBQ2pCLE9BQU8sQ0FBTTtJQUNiLFlBQ0UsUUFBa0IsRUFDVixZQUFnQyxFQUNoQyxNQUFvQixFQUNwQixNQUFzQixFQUN0QixPQUFlLEVBQ2YsYUFBK0I7UUFKL0IsaUJBQVksR0FBWixZQUFZLENBQW9CO1FBQ2hDLFdBQU0sR0FBTixNQUFNLENBQWM7UUFDcEIsV0FBTSxHQUFOLE1BQU0sQ0FBZ0I7UUFDdEIsWUFBTyxHQUFQLE9BQU8sQ0FBUTtRQUNmLGtCQUFhLEdBQWIsYUFBYSxDQUFrQjtRQUV2QyxJQUFJLENBQUMscUJBQXFCLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBd0IscUJBQXFCLENBQUMsQ0FBQztRQUN4RixJQUFJLENBQUMsZUFBZSxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQXlCLHNCQUFzQixDQUFDLENBQUM7UUFDcEYsSUFBSSxDQUFDLGtCQUFrQixHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQXFCLGtCQUFrQixDQUFDLENBQUM7UUFDL0UsSUFBSSxDQUFDLFdBQVcsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFjLFdBQVcsQ0FBQyxDQUFDO1FBQzFELElBQUksQ0FBQyxVQUFVLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBZSxZQUFZLENBQUMsQ0FBQztRQUMzRCxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3pELElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQVEsRUFBRSxFQUFFO1lBQ3JELElBQUksR0FBRyxFQUFFO2dCQUNQLElBQUksQ0FBQyxXQUFXLEdBQUcsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDO2dCQUN0QyxJQUFJLENBQUMsT0FBTyxHQUFHLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztnQkFDOUIsSUFBSSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO2dCQUM3QyxJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7b0JBQ2QsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO2lCQUNwQjthQUNGO1FBQ0gsQ0FBQyxDQUFDLENBQUE7UUFDRixJQUFJLENBQUMsb0JBQW9CLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsc0JBQXNCLENBQUMsQ0FBQztJQUU3RSxDQUFDO0lBRUQsUUFBUTtRQUNOLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ1osTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3pDLElBQUksQ0FBQyxVQUFVLEVBQUU7Z0JBQ2YsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxtQ0FBbUMsQ0FBQyxFQUFFLEVBQUUsVUFBVSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO2dCQUMxRixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLHlDQUF5QyxDQUFDLENBQUM7YUFDckU7U0FDRjtRQUNELElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUNwQixJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztJQUMzQixDQUFDO0lBQ0QsY0FBYztRQUNaLElBQ0UsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsUUFBUTtZQUNuQyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRO1lBQ25DLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsRUFDdEM7WUFDQSxPQUFPLEtBQUssQ0FBQztTQUNkO2FBQU07WUFDTCxPQUFPLElBQUksQ0FBQztTQUNiO0lBQ0gsQ0FBQztJQUVELFdBQVc7UUFDVCxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQzdCLENBQUM7SUFFRCxrQkFBa0I7UUFDaEIsSUFBSSxDQUFDLHFCQUFxQixDQUFDLGVBQWUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRTtZQUNqRSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztZQUNyQixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztZQUM5RSxJQUFJLFNBQVMsRUFBRTtnQkFDYixNQUFNLFdBQVcsR0FBcUIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ3JFLFdBQVcsQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDO2dCQUMxQixJQUFJLFNBQVMsRUFBRSxNQUFNLEVBQUU7b0JBQ3JCLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUU7d0JBQy9CLFdBQVcsQ0FBQyxJQUFJLENBQ2QsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUM7NEJBQ3RCLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFBRTs0QkFDVixJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUk7NEJBQ2QsS0FBSyxFQUFFLEdBQUcsQ0FBQyxLQUFLOzRCQUNoQixNQUFNLEVBQUUsR0FBRyxDQUFDLE1BQU07NEJBQ2xCLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSTt5QkFDZixDQUFDLENBQ0gsQ0FBQzt3QkFDRixJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUM7b0JBQy9CLENBQUMsQ0FBQyxDQUFDO2lCQUNKO2FBQ0Y7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxpQkFBaUI7UUFDZixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDO1lBQ3RDLElBQUksRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDO1NBQ3BELENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxZQUFZO1FBQ1YsSUFBSSxDQUFDLGVBQWUsQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDaEUsSUFBSSxDQUFDLFlBQVksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDckMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsV0FBVztRQUNULElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLFNBQVMsQ0FDekQsQ0FBQyxHQUFRLEVBQUUsRUFBRTtZQUNYLElBQUksR0FBRyxFQUFFO2dCQUNQLElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsZUFBZSxFQUFFLEdBQUcsS0FBSyxLQUFLLENBQUMsQ0FBQztnQkFDaEYsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7YUFDM0I7UUFDSCxDQUFDLEVBQ0QsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsWUFBWSxDQUFDLENBQ3JELENBQUM7SUFDSixDQUFDO0lBRUQsNEJBQTRCO0lBQzVCLHdCQUF3QjtJQUN4Qiw2RkFBNkY7SUFDN0YsSUFBSTtJQUVJLFdBQVc7UUFDakIsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQztZQUM3QixJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDakMsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQy9CLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQztZQUNYLE1BQU0sRUFBRSxDQUFDLEVBQUUsQ0FBQztZQUNaLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQztZQUNWLFNBQVMsRUFBRSxDQUFDLEVBQUUsQ0FBQztTQUNoQixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsSUFBSSxJQUFJO1FBQ04sT0FBUSxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQXNCLENBQUMsUUFBZ0MsQ0FBQztJQUMxRixDQUFDO0lBRUQsTUFBTTtRQUNKLE1BQU0sSUFBSSxHQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBc0IsQ0FBQyxRQUFRLENBQUM7UUFDdEUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztRQUM5QixJQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQztRQUMxQixJQUFJLENBQUMsYUFBYSxHQUFHLEtBQUssQ0FBQztJQUM3QixDQUFDO0lBRUQsdUJBQXVCO0lBQ3ZCLG9FQUFvRTtJQUNwRSx5QkFBeUI7SUFDekIsSUFBSTtJQUVKLE1BQU07SUFDTiwwQkFBMEI7SUFDMUIsa0RBQWtEO0lBQ2xELE1BQU07SUFDTixTQUFTLENBQUMsTUFBYztRQUN0QixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQXFCLENBQUM7UUFDM0QsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN4QixDQUFDO0lBRUQsc0JBQXNCO0lBQ3RCLHFCQUFxQjtJQUNyQiwyQkFBMkI7SUFDM0Isb0VBQW9FO0lBQ3BFLE1BQU07SUFDTixJQUFJO0lBQ0osTUFBTTtRQUNKLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUM1QyxDQUFDO0lBRUQsUUFBUSxDQUFDLE9BQWdCO1FBQ3ZCLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDO1FBQ3pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNqQyw0QkFBNEI7UUFDNUIsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxJQUFJLENBQUM7UUFDOUMsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7UUFDekIsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7UUFDMUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUNqQixHQUFHLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsZUFBZSxFQUFFLEdBQUcsQ0FBQztZQUM3RyxHQUFHLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQ3hCLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsYUFBYSxFQUFFLGlCQUFpQixDQUM5RyxFQUFFLFNBQVMsQ0FBQztZQUNiLEdBQUcsQ0FBQyxlQUFlLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQy9DLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDMUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDM0IsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDWixJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUM7WUFDbEMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUN0RSxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQzVCLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsOEJBQThCLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ2pFLElBQUksT0FBTyxFQUFFO29CQUNYLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUNqQixvQkFBb0IsSUFBSSxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sNkJBQTZCLENBQzVGLENBQUM7aUJBQ0g7cUJBQU07b0JBQ0wsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsNkJBQTZCLENBQUMsQ0FBQztpQkFDcEQ7WUFDSCxDQUFDLENBQUMsQ0FBQztTQUNKO2FBQU07WUFDTCxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1lBQ2xDLFdBQVcsQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUN6QixXQUFXLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQztZQUNoQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFO2dCQUM3RSxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLDhCQUE4QixXQUFXLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUM1RSxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1lBQ3ZELENBQUMsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDO0lBRUQsUUFBUSxDQUFDLEtBQUssRUFBRSxLQUFhO1FBQzNCLElBQUksS0FBSyxFQUFFO1lBQ1QsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDMUcsTUFBTSxZQUFZLEdBQUcsWUFBWSxDQUFDLGFBQWE7Z0JBQzdDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBRSxhQUFhLEVBQUUsaUJBQWlCLENBQUMsRUFBRSxZQUFZO2dCQUMxRSxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQ1AsTUFBTSxJQUFJLEdBQ1IsWUFBWSxJQUFJLFlBQVksRUFBRSxNQUFNO2dCQUNsQyxDQUFDLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBRTtvQkFDM0IsT0FBTyxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUMsU0FBUyxHQUFHLEdBQUcsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDO29CQUN4RCxPQUFPLE9BQU8sQ0FBQztnQkFDakIsQ0FBQyxDQUFDO2dCQUNGLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDVCxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7U0FDMUM7YUFBTTtZQUNMLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsWUFBWSxHQUFHLEVBQUUsQ0FBQztTQUN4QztJQUNILENBQUM7d0dBNU9VLGtCQUFrQjs0RkFBbEIsa0JBQWtCLHNEQ2pCL0IsdzZLQXVIQTs7NEZEdEdhLGtCQUFrQjtrQkFMOUIsU0FBUzsrQkFDRSxnQkFBZ0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEluamVjdG9yLCBPbkRlc3Ryb3ksIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBVbnR5cGVkRm9ybUFycmF5LCBVbnR5cGVkRm9ybUJ1aWxkZXIsIFVudHlwZWRGb3JtQ29udHJvbCwgVW50eXBlZEZvcm1Hcm91cCwgVmFsaWRhdG9ycyB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgQWN0aXZhdGVkUm91dGUsIFJvdXRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBBcHBDb25zdGFudHMgfSBmcm9tICcuLi8uLi8uLi9AY29yZS9jb25zdGFudHMvYXBwLWNvbnN0YW50cyc7XHJcbmltcG9ydCB7IEFsZXJ0U2VydmljZSB9IGZyb20gJy4uLy4uLy4uL0Bjb3JlL3NlcnZpY2VzL2FsZXJ0LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBBdXRoU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL0Bjb3JlL3NlcnZpY2VzL2F1dGguc2VydmljZSc7XHJcbmltcG9ydCB7IENvbW1vbkRyb3Bkb3duc1NlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9AY29yZS9zZXJ2aWNlcy9jb21tb24tZHJvcGRvd25zLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEYXRhU3RvcmVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vQGNvcmUvc2VydmljZXMvZGF0YS1zdG9yZS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTG9jYWxTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vQGNvcmUvc2VydmljZXMvbG9jYWwuc2VydmljZSc7XHJcbmltcG9ydCB7IFBhZ2VCdWlsZGVyQWRkU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL0Bjb3JlL3NlcnZpY2VzL3BhZ2UtYnVpbGRlci1hZGQuc2VydmljZSc7XHJcbmltcG9ydCB7IFBhZ2VCdWlsZGVyU2VydmljZSB9IGZyb20gJy4uLy4uL3BhZ2UtYnVpbGRlci12ZXJzaW9uL0Bjb3JlL3BhZ2UtYnVpbGRlci5zZXJ2aWNlJztcclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtdGFiLWNvbmZpZycsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3RhYi1jb25maWcuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL3RhYi1jb25maWcuY29tcG9uZW50LnNjc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgVGFiQ29uZmlnQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xyXG4gIHRhYnNGb3JtITogVW50eXBlZEZvcm1Hcm91cDtcclxuICBmb3JtRGF0YTogYW55O1xyXG4gIGlkID0gJyc7XHJcbiAgcGFnZVR5cGVMaXN0OiBhbnk7XHJcbiAgZHJvcGRvd25TZXJ2aWNlOiBDb21tb25Ecm9wZG93bnNTZXJ2aWNlO1xyXG4gIHBhZ2VMaXN0OiBhbnk7XHJcbiAgZmlsdGVyZWRQYWdlTGlzdDogYW55O1xyXG4gIHBhZ2VCdWlsZGVyQWRkU2VydmljZTogUGFnZUJ1aWxkZXJBZGRTZXJ2aWNlO1xyXG4gIHBhZ2VCdWlsZGVyU2VydmljZTogUGFnZUJ1aWxkZXJTZXJ2aWNlO1xyXG4gIGF1dGhTZXJ2aWNlOiBBdXRoU2VydmljZTtcclxuICBvcmdTdWJzOiBTdWJzY3JpcHRpb247XHJcbiAgb3JnSWQ6IGFueTtcclxuICBmaWVsZExpc3Q6IGFueSA9IFtdO1xyXG4gIGFsbEZpZWxkTGlzdDogYW55ID0gW107XHJcbiAgcGFyZW50RmllbGRMaXN0OiBhbnkgPSBbXTtcclxuICB0ZW1wTGlzdDogYW55ID0gW107XHJcbiAgcGFnZUVycm9yU2hvdyA9IGZhbHNlO1xyXG4gIHRhYkVycm9yU2hvdyA9IGZhbHNlO1xyXG4gIGJhc2ljUGFnZUluZm9ybWF0aW9uOiBhbnk7XHJcbiAgbG9jYWxTdG9yZTogTG9jYWxTZXJ2aWNlO1xyXG4gIGh0dHBTZXJ2aWNlOiBhbnk7XHJcbiAgUkJBQ09SRzogYW55O1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgcHJpdmF0ZSBfZm9ybUJ1aWxkZXI6IFVudHlwZWRGb3JtQnVpbGRlcixcclxuICAgIHByaXZhdGUgX2FsZXJ0OiBBbGVydFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIF9yb3V0ZTogQWN0aXZhdGVkUm91dGUsXHJcbiAgICBwcml2YXRlIF9yb3V0ZXI6IFJvdXRlcixcclxuICAgIHByaXZhdGUgX3N0b3Jlc2VydmljZTogRGF0YVN0b3JlU2VydmljZSxcclxuICApIHtcclxuICAgIHRoaXMucGFnZUJ1aWxkZXJBZGRTZXJ2aWNlID0gaW5qZWN0b3IuZ2V0PFBhZ2VCdWlsZGVyQWRkU2VydmljZT4oUGFnZUJ1aWxkZXJBZGRTZXJ2aWNlKTtcclxuICAgIHRoaXMuZHJvcGRvd25TZXJ2aWNlID0gaW5qZWN0b3IuZ2V0PENvbW1vbkRyb3Bkb3duc1NlcnZpY2U+KENvbW1vbkRyb3Bkb3duc1NlcnZpY2UpO1xyXG4gICAgdGhpcy5wYWdlQnVpbGRlclNlcnZpY2UgPSBpbmplY3Rvci5nZXQ8UGFnZUJ1aWxkZXJTZXJ2aWNlPihQYWdlQnVpbGRlclNlcnZpY2UpO1xyXG4gICAgdGhpcy5hdXRoU2VydmljZSA9IGluamVjdG9yLmdldDxBdXRoU2VydmljZT4oQXV0aFNlcnZpY2UpO1xyXG4gICAgdGhpcy5sb2NhbFN0b3JlID0gaW5qZWN0b3IuZ2V0PExvY2FsU2VydmljZT4oTG9jYWxTZXJ2aWNlKTtcclxuICAgIHRoaXMuaWQgPSB0aGlzLl9yb3V0ZS5zbmFwc2hvdC5wYXJlbnQucGFyYW1NYXAuZ2V0KCdpZCcpO1xyXG4gICAgdGhpcy5fc3RvcmVzZXJ2aWNlLmN1cnJlbnRTdG9yZS5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgIGlmIChyZXMpIHtcclxuICAgICAgICB0aGlzLmh0dHBTZXJ2aWNlID0gcmVzWydIVFRQU0VSVklDRSddO1xyXG4gICAgICAgIHRoaXMuUkJBQ09SRyA9IHJlc1snUkJBQ09SRyddO1xyXG4gICAgICAgIHRoaXMub3JnSWQgPSBwYXJzZUludCh0aGlzLlJCQUNPUkdbJ29yZ0lEJ10pO1xyXG4gICAgICAgIGlmICh0aGlzLm9yZ0lkKSB7XHJcbiAgICAgICAgICB0aGlzLmdldEFsbFBhZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgdGhpcy5iYXNpY1BhZ2VJbmZvcm1hdGlvbiA9IHRoaXMubG9jYWxTdG9yZS5nZXRPYmooJ1BBR0VERVNJR05fQkFTSUNJTkZPJyk7XHJcblxyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICBpZiAoIXRoaXMuaWQpIHtcclxuICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGlvblBhZ2UoKTtcclxuICAgICAgaWYgKCF2YWxpZGF0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5fcm91dGVyLm5hdmlnYXRlKFsnL3BhZ2VzL3BhZ2UtZGVzaWduL2FkZC9iYXNpYy1pbmZvJ10sIHsgcmVsYXRpdmVUbzogdGhpcy5fcm91dGUgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FsZXJ0LmVycm9yKCdQbGVhc2UgZmlsbCBpbiBhbGwgdGhlIHJlcXVpcmVkIGZpZWxkcy4nKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5nZXRQYWdlVHlwZXMoKTtcclxuICAgIHRoaXMuaW5pdFRhYkNvbmZpZ0Zvcm0oKTtcclxuICB9XHJcbiAgdmFsaWRhdGlvblBhZ2UoKTogYW55IHtcclxuICAgIGlmIChcclxuICAgICAgIXRoaXMuYmFzaWNQYWdlSW5mb3JtYXRpb24ucGFnZW5hbWUgfHxcclxuICAgICAgIXRoaXMuYmFzaWNQYWdlSW5mb3JtYXRpb24ucGFnZXR5cGUgfHxcclxuICAgICAgIXRoaXMuYmFzaWNQYWdlSW5mb3JtYXRpb24uZGVzY3JpcHRpb25cclxuICAgICkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgdGhpcy5vcmdTdWJzLnVuc3Vic2NyaWJlKCk7XHJcbiAgfVxyXG5cclxuICBzZXRDdXJyZW50Rm9ybURhdGEoKSB7XHJcbiAgICB0aGlzLnBhZ2VCdWlsZGVyQWRkU2VydmljZS5jdXJyZW50Rm9ybURhdGEuc3Vic2NyaWJlKChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgdGhpcy5mb3JtRGF0YSA9IGRhdGE7XHJcbiAgICAgIGNvbnN0IHRhYkNvbmZpZyA9IHRoaXMuZm9ybURhdGEgPyBKU09OLnBhcnNlKHRoaXMuZm9ybURhdGE/LnRhYmNvbmZpZykgOiBudWxsO1xyXG4gICAgICBpZiAodGFiQ29uZmlnKSB7XHJcbiAgICAgICAgY29uc3QgdGFic0NvbnRyb2wgPSA8VW50eXBlZEZvcm1BcnJheT50aGlzLnRhYnNGb3JtLmNvbnRyb2xzWyd0YWJzJ107XHJcbiAgICAgICAgdGFic0NvbnRyb2wuY29udHJvbHMgPSBbXTtcclxuICAgICAgICBpZiAodGFiQ29uZmlnPy5sZW5ndGgpIHtcclxuICAgICAgICAgIHRhYkNvbmZpZy5mb3JFYWNoKCh2YWwsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIHRhYnNDb250cm9sLnB1c2goXHJcbiAgICAgICAgICAgICAgdGhpcy5fZm9ybUJ1aWxkZXIuZ3JvdXAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHZhbC5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IHZhbC5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZmllbGQ6IHZhbC5maWVsZCxcclxuICAgICAgICAgICAgICAgIHBmaWVsZDogdmFsLnBmaWVsZCxcclxuICAgICAgICAgICAgICAgIGljb246IHZhbC5pY29uXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdGhpcy5vbkNoYW5nZSh2YWwuaWQsIGluZGV4KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpbml0VGFiQ29uZmlnRm9ybSgpOiB2b2lkIHtcclxuICAgIHRoaXMudGFic0Zvcm0gPSB0aGlzLl9mb3JtQnVpbGRlci5ncm91cCh7XHJcbiAgICAgIHRhYnM6IHRoaXMuX2Zvcm1CdWlsZGVyLmFycmF5KFt0aGlzLmFkZFRhYkdyb3VwKCldKVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRQYWdlVHlwZXMoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRyb3Bkb3duU2VydmljZS5nZXREcm9wRG93blZhbHVlcygncGFnZScpLnN1YnNjcmliZShyZXN1bHQgPT4ge1xyXG4gICAgICB0aGlzLnBhZ2VUeXBlTGlzdCA9IHJlc3VsdFsnZGF0YSddO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRBbGxQYWdlcygpOiB2b2lkIHtcclxuICAgIHRoaXMucGFnZUJ1aWxkZXJBZGRTZXJ2aWNlLmdldE9yZ0xpc3QodGhpcy5vcmdJZCkuc3Vic2NyaWJlKFxyXG4gICAgICAocmVzOiBhbnkpID0+IHtcclxuICAgICAgICBpZiAocmVzKSB7XHJcbiAgICAgICAgICB0aGlzLnBhZ2VMaXN0ID0gcmVzPy5kYXRhPy5maWx0ZXIocGFnZSA9PiBwYWdlPy5wYWdlVHlwZURldGFpbHM/LmtleSAhPT0gJ0JUUCcpO1xyXG4gICAgICAgICAgdGhpcy5zZXRDdXJyZW50Rm9ybURhdGEoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIF9lcnIgPT4gdGhpcy5fYWxlcnQuZXJyb3IoQXBwQ29uc3RhbnRzLmVycm9yTWVzc2FnZSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvLyBzZWxlY3RlZFBhZ2VUeXBlKGV2ZW50KSB7XHJcbiAgLy8gICBjb25zb2xlLmxvZyhldmVudCk7XHJcbiAgLy8gICB0aGlzLmZpbHRlcmVkUGFnZUxpc3QgPSB0aGlzLnBhZ2VMaXN0LmZpbHRlcihwYWdlID0+IHBhZ2UucGFnZVR5cGVEZXRhaWxzLmlkID09PSBldmVudCk7XHJcbiAgLy8gfVxyXG5cclxuICBwcml2YXRlIGFkZFRhYkdyb3VwKCk6IGFueSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybUJ1aWxkZXIuZ3JvdXAoe1xyXG4gICAgICBuYW1lOiBbJycsIFtWYWxpZGF0b3JzLnJlcXVpcmVkXV0sXHJcbiAgICAgIGlkOiBbJycsIFtWYWxpZGF0b3JzLnJlcXVpcmVkXV0sXHJcbiAgICAgIGZpZWxkOiBbJyddLFxyXG4gICAgICBwZmllbGQ6IFsnJ10sXHJcbiAgICAgIGljb246IFsnJ10sXHJcbiAgICAgIHRhYmxlTmFtZTogWycnXVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXQgdGFicygpIHtcclxuICAgIHJldHVybiAodGhpcy50YWJzRm9ybS5nZXQoJ3RhYnMnKSBhcyBVbnR5cGVkRm9ybUFycmF5KS5jb250cm9scyBhcyBVbnR5cGVkRm9ybUNvbnRyb2xbXTtcclxuICB9XHJcblxyXG4gIGFkZFRhYigpIHtcclxuICAgIGNvbnN0IHRhYnMgPSAodGhpcy50YWJzRm9ybS5nZXQoJ3RhYnMnKSBhcyBVbnR5cGVkRm9ybUFycmF5KS5jb250cm9scztcclxuICAgIHRhYnMucHVzaCh0aGlzLmFkZFRhYkdyb3VwKCkpO1xyXG4gICAgdGhpcy50YWJFcnJvclNob3cgPSBmYWxzZTtcclxuICAgIHRoaXMucGFnZUVycm9yU2hvdyA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLy8gcGF0Y2hUYWIodGFiVmFsdWUpIHtcclxuICAvLyAgIGNvbnN0IHRhYnMgPSAodGhpcy50YWJzRm9ybS5nZXQoJ3RhYnMnKSBhcyBGb3JtQXJyYXkpLmNvbnRyb2xzO1xyXG4gIC8vICAgdGFicy5wdXNoKHRhYlZhbHVlKTtcclxuICAvLyB9XHJcblxyXG4gIC8vIC8qKlxyXG4gIC8vICAqIE1ldGhvZCB0byBSZW1vdmUgdGFiXHJcbiAgLy8gICogQHBhcmFtIF9pbmRleCBpbmRleCBvZiB0aGUgdGFiIHRvIGJlIHJlbW92ZWRcclxuICAvLyAgKi9cclxuICByZW1vdmVUYWIoX2luZGV4OiBudW1iZXIpIHtcclxuICAgIGNvbnN0IHRhYnMgPSB0aGlzLnRhYnNGb3JtLmdldCgndGFicycpIGFzIFVudHlwZWRGb3JtQXJyYXk7XHJcbiAgICB0YWJzLnJlbW92ZUF0KF9pbmRleCk7XHJcbiAgfVxyXG5cclxuICAvLyBnZXRQYWdlKGlkPzogYW55KSB7XHJcbiAgLy8gICBjb25zb2xlLmxvZyhpZCk7XHJcbiAgLy8gICBpZiAoaWQgJiYgaWQgIT09ICcnKSB7XHJcbiAgLy8gICAgIHJldHVybiB0aGlzLnBhZ2VMaXN0LmZpbHRlcihfID0+IF8ucGFnZVR5cGVEZXRhaWxzLmlkID09IGlkKTtcclxuICAvLyAgIH1cclxuICAvLyB9XHJcbiAgY2FuY2VsKCkge1xyXG4gICAgdGhpcy5wYWdlQnVpbGRlckFkZFNlcnZpY2UucmV0dXJuVG9MaXN0KCk7XHJcbiAgfVxyXG5cclxuICBzYXZlVGFicyhwdWJsaXNoOiBib29sZWFuKSB7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLnRhYnNGb3JtLmdldFJhd1ZhbHVlKCkpO1xyXG4gICAgY29uc29sZS5sb2codGhpcy50YWJzRm9ybS52YWxpZCk7XHJcbiAgICAvLyBUT0RPOiBjaGFuZ2UgdG8gdGFiY29uZmlnXHJcbiAgICBjb25zdCB0YWJzID0gdGhpcy50YWJzRm9ybS5nZXRSYXdWYWx1ZSgpLnRhYnM7XHJcbiAgICB0aGlzLnRhYkVycm9yU2hvdyA9IHRydWU7XHJcbiAgICB0aGlzLnBhZ2VFcnJvclNob3cgPSB0cnVlO1xyXG4gICAgdGFicy5mb3JFYWNoKHRhYiA9PiB7XHJcbiAgICAgIHRhYi50eXBlID0gdGhpcy5wYWdlTGlzdC5sZW5ndGggJiYgdGhpcy5wYWdlTGlzdC5maWx0ZXIocGFnZSA9PiBwYWdlLmlkID09PSB0YWIuaWQpWzBdPy5wYWdlVHlwZURldGFpbHM/LmtleTtcclxuICAgICAgdGFiLnRhYmxlTmFtZSA9IEpTT04ucGFyc2UoXHJcbiAgICAgICAgdGhpcy5wYWdlTGlzdC5sZW5ndGggJiYgdGhpcy5wYWdlTGlzdC5maWx0ZXIocGFnZSA9PiBwYWdlLmlkID09PSB0YWIuaWQpWzBdPy5hY3RpdmVWZXJzaW9uPy50YWJsZXNjaGVtYWNvbmZpZ1xyXG4gICAgICApPy50YWJsZWxpc3Q7XHJcbiAgICAgIHRhYi5wYXJlbnRUYWJsZU5hbWUgPSB0YWIucGZpZWxkPy5zcGxpdCgnLicpWzBdO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmZvcm1EYXRhLnRhYmNvbmZpZyA9IEpTT04uc3RyaW5naWZ5KHRhYnMpO1xyXG4gICAgY29uc29sZS5sb2coJ1NhdmluZy4uLi4nKTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybURhdGEpO1xyXG4gICAgaWYgKCF0aGlzLmlkKSB7XHJcbiAgICAgIHRoaXMuZm9ybURhdGEucHVibGlzaGVkID0gcHVibGlzaDtcclxuICAgICAgdGhpcy5wYWdlQnVpbGRlckFkZFNlcnZpY2UuY3JlYXRlUGFnZSh0aGlzLmZvcm1EYXRhKS5zdWJzY3JpYmUocmVzdWx0ID0+IHtcclxuICAgICAgICBjb25zdCBkYXRhID0gcmVzdWx0WydkYXRhJ107XHJcbiAgICAgICAgdGhpcy5fcm91dGVyLm5hdmlnYXRlKFtgcGFnZXMvcGFnZS1kZXNpZ24vdmVyc2lvbnMvJHtkYXRhLmlkfWBdKTtcclxuICAgICAgICBpZiAocHVibGlzaCkge1xyXG4gICAgICAgICAgdGhpcy5fYWxlcnQuc3VjY2VzcyhcclxuICAgICAgICAgICAgYFRhYiBQYWdlIFZlcnNpb24gJHtkYXRhLnZlcnNpb24gfHwgZGF0YS5hY3RpdmVWZXJzaW9uLnZlcnNpb259ICBpcyBwdWJsaXNoZWQgc3VjY2Vzc2Z1bGx5YFxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5fYWxlcnQuc3VjY2VzcygnVGFiIFBhZ2UgYWRkZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IGZvcm1EZXRhaWxzID0gdGhpcy5mb3JtRGF0YTtcclxuICAgICAgZm9ybURldGFpbHMuaWQgPSB0aGlzLmlkO1xyXG4gICAgICBmb3JtRGV0YWlscy5wdWJsaXNoZWQgPSBwdWJsaXNoO1xyXG4gICAgICB0aGlzLnBhZ2VCdWlsZGVyU2VydmljZS51cGRhdGVQYWdlVmVyc2lvbih0aGlzLmlkLCBmb3JtRGV0YWlscykuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICB0aGlzLl9yb3V0ZXIubmF2aWdhdGUoW2BwYWdlcy9wYWdlLWRlc2lnbi92ZXJzaW9ucy8ke2Zvcm1EZXRhaWxzLnBhZ2VpZH1gXSk7XHJcbiAgICAgICAgdGhpcy5fYWxlcnQuc3VjY2VzcygnVGFiIFBhZ2UgdXBkYXRlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbkNoYW5nZSh2YWx1ZSwgaW5kZXg6IG51bWJlcikge1xyXG4gICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgIGNvbnN0IHNlbGVjdGVkUGFnZSA9IHRoaXMucGFnZUxpc3QgJiYgdGhpcy5wYWdlTGlzdD8ubGVuZ3RoID8gdGhpcy5wYWdlTGlzdC5maW5kKHggPT4geC5pZCA9PSB2YWx1ZSkgOiB7fTtcclxuICAgICAgY29uc3QgZmllbGRtYXBwaW5nID0gc2VsZWN0ZWRQYWdlLmFjdGl2ZVZlcnNpb25cclxuICAgICAgICA/IEpTT04ucGFyc2Uoc2VsZWN0ZWRQYWdlPy5hY3RpdmVWZXJzaW9uPy50YWJsZXNjaGVtYWNvbmZpZyk/LmZpZWxkbWFwcGluZ1xyXG4gICAgICAgIDogW107XHJcbiAgICAgIGNvbnN0IGRhdGEgPVxyXG4gICAgICAgIGZpZWxkbWFwcGluZyAmJiBmaWVsZG1hcHBpbmc/Lmxlbmd0aFxyXG4gICAgICAgICAgPyBmaWVsZG1hcHBpbmcubWFwKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICBlbGVtZW50LmxhYmVsID0gZWxlbWVudC50YWJsZW5hbWUgKyAnLicgKyBlbGVtZW50LmZpZWxkO1xyXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICA6IFtdO1xyXG4gICAgICB0aGlzLnBhZ2VMaXN0W2luZGV4XS5maWVsZG1hcHBpbmcgPSBkYXRhO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5wYWdlTGlzdFtpbmRleF0uZmllbGRtYXBwaW5nID0gW107XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsIjxkaXYgY2xhc3M9XCJwYWdlLWRlc2lnbi1iYXNpYy1pbmZvXCI+XHJcbiAgPHAtY2FyZCBzdHlsZUNsYXNzPVwicmJhYy1jYXJkIHctMTAwIG1iLTJcIj5cclxuICAgIDxkaXYgY2xhc3M9XCJzdHJpcF9oZWFkIHBhZ2UtZGVzaWduZXIgdG9nZ2xlbGVmdFwiPlxyXG4gICAgICA8c3BhbiBjbGFzcz1cInJlcG9ydF9oZWFkIGZvbnQtd2VpZ2h0LWJvbGRcIj5UYWIgQ29uZmlndXJhdGlvbjwvc3Bhbj5cclxuICAgIDwvZGl2PlxyXG4gICAgPGRpdiBjbGFzcz1cInAtZmx1aWRcIj5cclxuICAgICAgPGRpdiBjbGFzcz1cIlwiPlxyXG4gICAgICAgIDxmb3JtIFtmb3JtR3JvdXBdPVwidGFic0Zvcm1cIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdHJpcF9oZWFkIHRvZ2dsZWxlZnQgcGFnZS1kZXNpZ25lciBkLWZsZXgganVzdGlmeS1jb250ZW50LWJldHdlZW4gbWItNFwiPlxyXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cInJlcG9ydF9oZWFkIGZvbnQtd2VpZ2h0LWJvbGRcIj48L3NwYW4+XHJcbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIiBmaWVsZEtleT1cIlBBR19ERVNfVEFCX0NPTkZJR19BRERfVEFCXCIgKGNsaWNrKT1cImFkZFRhYigpXCI+XHJcbiAgICAgICAgICAgICAgPGVtIGNsYXNzPVwiZmEgZmEtcGx1c1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvZW0+IEFkZCBUYWJcclxuICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDx0YWJsZSBhcmlhLWRlc2NyaWJlZGJ5PVwiZ3JpZENvbmZpZ1RhYmxlXCIgY2xhc3M9XCJ0YWJsZSB0YWJsZS1ib3JkZXJsZXNzIGFjdGlvbmFkZCBtYi0wXCI+XHJcbiAgICAgICAgICAgIDx0aGVhZD5cclxuICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICA8dGggc2NvcGU9XCJjb2xcIj5UYWIgTmFtZSA8c3BhbiBjbGFzcz1cInJlcXVpcmVkZmllbGQgdGV4dC1kYW5nZXJcIj4qPC9zcGFuPjwvdGg+XHJcbiAgICAgICAgICAgICAgICA8dGggc2NvcGU9XCJjb2xcIj5JY29uPC90aD5cclxuICAgICAgICAgICAgICAgIDx0aCBzY29wZT1cImNvbFwiPlBhZ2UgPHNwYW4gY2xhc3M9XCJyZXF1aXJlZGZpZWxkIHRleHQtZGFuZ2VyXCI+Kjwvc3Bhbj48L3RoPlxyXG4gICAgICAgICAgICAgICAgPHRoIHNjb3BlPVwiY29sXCI+RmllbGQgTWFwcGluZzwvdGg+XHJcbiAgICAgICAgICAgICAgICA8dGggc2NvcGU9XCJjb2xcIj5QYXJlbnQgRmllbGQgTWFwcGluZzwvdGg+XHJcbiAgICAgICAgICAgICAgICA8dGggc2NvcGU9XCJjb2xcIj4mIzE2MDs8L3RoPlxyXG4gICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgIDwvdGhlYWQ+XHJcbiAgICAgICAgICAgIDx0Ym9keSBmb3JtQXJyYXlOYW1lPVwidGFic1wiICpuZ0Zvcj1cImxldCBpdGVtIG9mIHRhYnM7IGxldCBpID0gaW5kZXhcIj5cclxuICAgICAgICAgICAgICA8dHIgW2Zvcm1Hcm91cE5hbWVdPVwiaVwiPlxyXG4gICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICA8aW5wdXRcclxuICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIlxyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1Db250cm9sTmFtZT1cIm5hbWVcIlxyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiUEFHX0RFU19UQUJfQ09ORklHX1RBQl9OQU1FXCJcclxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkVudGVyIFRhYiBOYW1lXCJcclxuICAgICAgICAgICAgICAgICAgICBwSW5wdXRUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQgLz5cclxuICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICpuZ0lmPVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICB0YWJFcnJvclNob3cgPyBpdGVtLmdldCgnbmFtZScpLmludmFsaWQgOiBpdGVtLmdldCgnbmFtZScpLmVycm9ycyAmJiBpdGVtLmdldCgnbmFtZScpLnRvdWNoZWRcclxuICAgICAgICAgICAgICAgICAgICBcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicC1lcnJvciBibG9jayBtdC0xXCI+VGFiIE5hbWUgaXMgcmVxdWlyZWQgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcclxuICAgICAgICAgICAgICAgICAgICBmb3JtQ29udHJvbE5hbWU9XCJpY29uXCJcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cIlBBR19ERVNfVEFCX0NPTkZJR19UQUJfTkFNRVwiXHJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJFbnRlciBJY29uXCJcclxuICAgICAgICAgICAgICAgICAgICBwSW5wdXRUZXh0IC8+XHJcbiAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICA8cC1kcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgIFtvcHRpb25zXT1cInRoaXMucGFnZUxpc3RcIlxyXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiU2VsZWN0IFBhZ2VcIlxyXG4gICAgICAgICAgICAgICAgICAgIGlkPVwicGFnZXR5cGVcIlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbkxhYmVsPVwiYWN0aXZlVmVyc2lvbi5wYWdlbmFtZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRLZXk9XCJQQUdfREVTX1RBQl9DT05GSUdfU0VMRUNUX1BBR0VcIlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvblZhbHVlPVwiaWRcIlxyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1Db250cm9sTmFtZT1cImlkXCJcclxuICAgICAgICAgICAgICAgICAgICBbZmlsdGVyXT1cInRydWVcIlxyXG4gICAgICAgICAgICAgICAgICAgIChvbkNoYW5nZSk9XCJvbkNoYW5nZSgkZXZlbnQudmFsdWUsIGkpXCJcclxuICAgICAgICAgICAgICAgICAgICBbcmVxdWlyZWRdPVwidHJ1ZVwiPlxyXG4gICAgICAgICAgICAgICAgICA8L3AtZHJvcGRvd24+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgKm5nSWY9XCJwYWdlRXJyb3JTaG93ID8gaXRlbS5nZXQoJ2lkJykuaW52YWxpZCA6IGl0ZW0uZ2V0KCdpZCcpLmVycm9ycyAmJiBpdGVtLmdldCgnaWQnKS50b3VjaGVkXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInAtZXJyb3IgYmxvY2sgbXQtMVwiPlBhZ2UgaXMgcmVxdWlyZWQgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgPHAtZHJvcGRvd25cclxuICAgICAgICAgICAgICAgICAgICBbb3B0aW9uc109XCJwYWdlTGlzdCAmJiBwYWdlTGlzdD8ubGVuZ3RoID8gcGFnZUxpc3RbaV0uZmllbGRtYXBwaW5nIDogW11cIlxyXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiU2VsZWN0IEZpZWxkXCJcclxuICAgICAgICAgICAgICAgICAgICBpZD1cImZpZWxkXCJcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25MYWJlbD1cImZpZWxkXCJcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cIlBBR19ERVNfVEFCX0NPTkZJR19TRUxFQ1RfUEFHRVwiXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uVmFsdWU9XCJmaWVsZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgZm9ybUNvbnRyb2xOYW1lPVwiZmllbGRcIlxyXG4gICAgICAgICAgICAgICAgICAgIFtmaWx0ZXJdPVwidHJ1ZVwiPlxyXG4gICAgICAgICAgICAgICAgICA8L3AtZHJvcGRvd24+XHJcbiAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICA8cC1kcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgIFtvcHRpb25zXT1cInRoaXMucGFyZW50RmllbGRMaXN0W2ldXCJcclxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlNlbGVjdCBQYXJlbnQgRmllbGRcIlxyXG4gICAgICAgICAgICAgICAgICAgIGlkPVwiZmllbGRcIlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbkxhYmVsPVwibGFiZWxcIlxyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkS2V5PVwiUEFHX0RFU19UQUJfQ09ORklHX1NFTEVDVF9QQUdFXCJcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25WYWx1ZT1cImxhYmVsXCJcclxuICAgICAgICAgICAgICAgICAgICBmb3JtQ29udHJvbE5hbWU9XCJwZmllbGRcIlxyXG4gICAgICAgICAgICAgICAgICAgIFtmaWx0ZXJdPVwidHJ1ZVwiPlxyXG4gICAgICAgICAgICAgICAgICA8L3AtZHJvcGRvd24+XHJcbiAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzPVwidGV4dC1jZW50ZXJcIiAqbmdJZj1cInRhYnMubGVuZ3RoID4gMVwiPlxyXG4gICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIlxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwidGV4dC1kYW5nZXIgdHJhc2gtYWxpZ25cIlxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiRGVsZXRlXCJcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZEtleT1cIlBBR19ERVNfVEFCX0NPTkZJR19ERUxFVEVcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZW0gY2xhc3M9XCJwaSBwaS10cmFzaFwiIChjbGljayk9XCJyZW1vdmVUYWIoaSlcIj48L2VtPlxyXG4gICAgICAgICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgIDwvdGJvZHk+XHJcbiAgICAgICAgICA8L3RhYmxlPlxyXG4gICAgICAgIDwvZm9ybT5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICA8L3AtY2FyZD5cclxuICA8ZGl2IGNsYXNzPVwiZm9ybWljb24gbXQtMyB0ZXh0LXJpZ2h0XCI+XHJcbiAgICA8YnV0dG9uIGNsYXNzPVwibWItMiBtci0yIGJ0biBidG4tY2FuY2VsXCIgKGNsaWNrKT1cImNhbmNlbCgpXCI+Q2FuY2VsPC9idXR0b24+XHJcbiAgICA8YnV0dG9uIGNsYXNzPVwibWItMiBtci0yIGJ0biBidG4tcHJpbWFyeSBidG5jb21tb25cIiBmaWVsZEtleT1cIlBBR19ERVNfVEFCX0NPTkZJR19QVUJMSVNIXCIgKGNsaWNrKT1cInNhdmVUYWJzKHRydWUpXCI+XHJcbiAgICAgIFB1Ymxpc2hcclxuICAgIDwvYnV0dG9uPlxyXG4gICAgPGJ1dHRvbiBjbGFzcz1cIm1iLTIgYnRuIGJ0bi1wcmltYXJ5IGJ0bmNvbW1vblwiIGZpZWxkS2V5PVwiUEFHX0RFU19UQUJfQ09ORklHX1NBVkVfVEFCU1wiIChjbGljayk9XCJzYXZlVGFicyhmYWxzZSlcIj5cclxuICAgICAgU2F2ZVxyXG4gICAgPC9idXR0b24+XHJcbiAgPC9kaXY+XHJcbjwvZGl2PlxyXG4iXX0=